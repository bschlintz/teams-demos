!function(e){var t={};function o(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(r,i,function(t){return e[t]}.bind(null,i));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=2)}([function(e,t){e.exports=require("botbuilder")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=o(0),i=o(11),n=o(12);class s extends r.TeamsActivityHandler{constructor(){super()}handleTeamsMessagingExtensionFetchTask(e,t){const s=o(13);n.find(s.body,{id:"foodTruckSelector"}).choices=i.default.map(e=>({value:e.id,title:`${e.name} - ${e.city}`}));let a={task:{type:"continue",value:{card:r.CardFactory.adaptiveCard(s),title:"Food Truck Selector",height:150,width:500}}};return Promise.resolve(a)}handleTeamsMessagingExtensionSubmitAction(e,t){switch(t.commandId){case"foodTruckExpanderAction":console.log("action",t);const e=i.default.find(e=>`${e.id}`===t.data.foodTruckSelector),o=this.getFoodTruckDetailCard(e);return Promise.resolve({composeExtension:{type:"result",attachmentLayout:"list",attachments:[o]}});default:throw new Error("NotImplemented")}}getFoodTruckDetailCard(e){const t=o(14);t.actions[0].url=`https://www.yelp.com/search?find_desc=${e.name}&find_loc=${e.city}`,n.find(t.body,{id:"cardHeader"}).items[0].text=`${e.name} - ${e.city}`;const i=n.find(t.body,{id:"cardBody"}),s=n.find(i.items,{id:"foodTruckDetails"});return n.find(s.columns[0].items[0].facts,{id:"likes"}).value=e.likes,n.find(s.columns[0].items[0].facts,{id:"sweet"}).value=e.sweet?"Yes":"No",n.find(s.columns[0].items[0].facts,{id:"savory"}).value=e.savory?"Yes":"No",n.find(s.columns[0].items[0].facts,{id:"vegetarian"}).value=e.vegetarian?"Yes":"No",r.CardFactory.adaptiveCard(t)}handleTeamsMessagingExtensionQuery(e,t){let o="";t&&t.parameters&&"searchKeyword"===t.parameters[0].name&&t.parameters[0].value&&(o=t.parameters[0].value.trim().toLowerCase());let r=i.default.filter(e=>e.name.toLowerCase().indexOf(o)>-1||e.city.toLowerCase().indexOf(o)>-1),n=[];r.forEach(e=>{n.push(this.getFoodTruckResultCard(e))});let s={composeExtension:{type:"result",attachmentLayout:"list",attachments:n}};return Promise.resolve(s)}getFoodTruckResultCard(e){return r.CardFactory.heroCard(`${e.name} - ${e.city}`)}}t.FoodTruckBot=s},function(e,t,o){e.exports=o(3)},function(e,t,o){"use strict";var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(i,n){function s(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new o((function(t){t(e.value)})).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(4),n=o(5),s=o(6),a=o(7),c=o(8),d=o(9),u=o(10),l=o(0),p=o(1),m=d("msteams");m("Initializing Microsoft Teams Express hosted App..."),o(15).config();const f=o(16),y=i(),v=process.env.port||process.env.PORT||3007;y.use(i.json({verify:(e,t,o,r)=>{e.rawBody=o.toString()}})),y.use(i.urlencoded({extended:!0})),y.set("views",s.join(__dirname,"/")),y.use(a("tiny")),y.use(u()),y.use("/scripts",i.static(s.join(__dirname,"web/scripts"))),y.use("/assets",i.static(s.join(__dirname,"web/assets"))),y.use(c.MsTeamsApiRouter(f)),y.use(c.MsTeamsPageRouter({root:s.join(__dirname,"web/"),components:f})),y.use("/",i.static(s.join(__dirname,"web/"),{index:"index.html"})),y.set("port",v),n.createServer(y).listen(v,()=>{m(`Server running on ${v}`)});const h=new l.BotFrameworkAdapter({appId:process.env.MICROSOFT_APP_ID,appPassword:process.env.MICROSOFT_APP_PASSWORD});h.onTurnError=(e,t)=>r(this,void 0,void 0,(function*(){console.error(`\n [bot.onTurnError] unhandled error: ${t}`),yield e.sendTraceActivity("OnTurnError Trace",`${t}`,"https://www.botframework.com/schemas/error","TurnError"),yield e.sendActivity("bot error")}));const b=new p.FoodTruckBot;y.post("/api/messages",(e,t)=>{h.processActivity(e,t,e=>r(this,void 0,void 0,(function*(){yield b.run(e)})))})},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("express-msteams-host")},function(e,t){e.exports=require("debug")},function(e,t){e.exports=require("compression")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{id:1,name:"Pizza Buildana",likes:10,savory:!0,sweet:!1,vegetarian:!0,bookable:!0,city:"Austin, TX"},{id:2,name:"Grab and Dip",likes:5,savory:!1,sweet:!0,vegetarian:!0,bookable:!1,city:"Denver, CO"},{id:3,name:"Thai Cart",likes:17,savory:!0,sweet:!0,vegetarian:!0,bookable:!1,city:"Austin, TX"},{id:4,name:"Curry And Go",likes:54,savory:!0,sweet:!1,vegetarian:!0,bookable:!0,city:"Portland, OR"},{id:5,name:"The big fat pork",likes:9,savory:!0,sweet:!1,vegetarian:!0,bookable:!1,city:"Seattle, WA"},{id:6,name:"The French corner",likes:2,savory:!0,sweet:!0,vegetarian:!0,bookable:!0,city:"Seattle, WA"},{id:7,name:"Mexican Fiesta",likes:44,savory:!0,sweet:!1,vegetarian:!1,bookable:!1,city:"Seattle"}]},function(e,t){e.exports=require("lodash")},function(e){e.exports={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.0",body:[{type:"Container",items:[{type:"TextBlock",size:"medium",isSubtle:!0,text:"Select a food truck to insert into the message:"}]},{type:"Input.ChoiceSet",id:"foodTruckSelector",choices:[]}],actions:[{type:"Action.Submit",title:"Insert selected food truck",data:{submitLocation:"messagingExtensionFetchTask"}}]}},function(e){e.exports={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.0",body:[{id:"cardHeader",type:"Container",items:[{id:"foodTruckName",type:"TextBlock",weight:"bolder",size:"medium"}]},{type:"Container",id:"cardBody",items:[{id:"foodTruckDetails",type:"ColumnSet",columns:[{type:"Column",width:"250",items:[{type:"FactSet",facts:[{id:"likes",title:"Likes:"},{id:"sweet",title:"Is Sweet:"},{id:"savory",title:"Is Savory:"},{id:"vegetarian",title:"Is Vegetarian:"}]}]}]}]}],actions:[{type:"Action.OpenUrl",title:"Read Yelp Reviews"}]}},function(e,t){e.exports=require("dotenv")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nonce={},function(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}(o(1))}]);
//# sourceMappingURL=server.js.map