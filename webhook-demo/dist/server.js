!function(e){var t={};function r(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(i,o,function(t){return e[t]}.bind(null,o));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t){e.exports=require("express-msteams-host")},function(e,t,r){e.exports=r(2)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(3),o=r(4),n=r(5),s=r(6),a=r(0),c=r(7),u=r(8),d=c("msteams");d("Initializing Microsoft Teams Express hosted App..."),r(9).config();const l=r(10),f=i(),p=process.env.port||process.env.PORT||3007;f.use(i.json({verify:(e,t,r,i)=>{e.rawBody=r.toString()}})),f.use(i.urlencoded({extended:!0})),f.set("views",n.join(__dirname,"/")),f.use(s("tiny")),f.use(u()),f.use("/scripts",i.static(n.join(__dirname,"web/scripts"))),f.use("/assets",i.static(n.join(__dirname,"web/assets"))),f.use(a.MsTeamsApiRouter(l)),f.use(a.MsTeamsPageRouter({root:n.join(__dirname,"web/"),components:l})),f.use("/",i.static(n.join(__dirname,"web/"),{index:"index.html"})),f.set("port",p),o.createServer(f).listen(p,()=>{d(`Server running on ${p}`)})},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("debug")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("dotenv")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nonce={},function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(11))},function(e,t,r){"use strict";var i,o=this&&this.__decorate||function(e,t,r,i){var o,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(n<3?o(s):n>3?o(t,r,s):o(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0});const n=r(12),s=r(13),a=r(0),c=r(14),u=r(15);let d=i=class{constructor(){}requestHandler(e,t,r){const o=e.body;let a={type:n.ActivityTypes.Message};const c=process.env.SECURITY_TOKEN;if(c&&c.length>0){const t=e.headers.authorization,r=Buffer.from(e.rawBody,"utf8");if("HMAC "+s.createHmac("sha256",new Buffer(c,"base64")).update(r).digest("base64")===t){const e=i.scrubMessage(o.text);a=i.processAuthenticatedRequest(e)}else a.text="Error: message sender cannot be verified"}else a.text="Error: outgoing webhook is not configured with a security token";t.send(JSON.stringify(a))}static processAuthenticatedRequest(e){const t={type:n.ActivityTypes.Message},r=u.default.find(t=>t.name.trim().toLowerCase().indexOf(e.trim().toLowerCase())>-1||t.city.trim().toLowerCase().indexOf(e.trim().toLowerCase())>-1);return r?(t.type="result",t.attachmentLayout="list",t.attachments=[this.getFoodTruckDetailCard(r)]):t.text=`Echo ${e}`,t}static scrubMessage(e){return e.slice(e.lastIndexOf(">")+1,e.length).replace("&nbsp;","")}static getFoodTruckDetailCard(e){const t=r(16);t.actions[0].url=`https://www.yelp.com/search?find_desc=${e.name}&find_loc=${e.city}`,c.find(t.body,{id:"cardHeader"}).items[0].text=`${e.name} - ${e.city}`;const i=c.find(t.body,{id:"cardBody"}),o=c.find(i.items,{id:"foodTruckDetails"});return c.find(o.columns[0].items[0].facts,{id:"likes"}).value=e.likes,c.find(o.columns[0].items[0].facts,{id:"sweet"}).value=e.sweet?"Yes":"No",c.find(o.columns[0].items[0].facts,{id:"savory"}).value=e.savory?"Yes":"No",c.find(o.columns[0].items[0].facts,{id:"vegetarian"}).value=e.vegetarian?"Yes":"No",n.CardFactory.adaptiveCard(t)}};d=i=o([a.OutgoingWebhookDeclaration("/api/webhook")],d),t.FoodTruckFindrOutgoingWebhook=d},function(e,t){e.exports=require("botbuilder")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("lodash")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{id:1,name:"Pizza Buildana",likes:10,savory:!0,sweet:!1,vegetarian:!0,bookable:!0,city:"Austin, TX"},{id:2,name:"Grab and Dip",likes:5,savory:!1,sweet:!0,vegetarian:!0,bookable:!1,city:"Denver, CO"},{id:3,name:"Thai Cart",likes:17,savory:!0,sweet:!0,vegetarian:!0,bookable:!1,city:"Austin, TX"},{id:4,name:"Curry And Go",likes:54,savory:!0,sweet:!1,vegetarian:!0,bookable:!0,city:"Portland, OR"},{id:5,name:"The big fat pork",likes:9,savory:!0,sweet:!1,vegetarian:!0,bookable:!1,city:"Seattle, WA"},{id:6,name:"The French corner",likes:2,savory:!0,sweet:!0,vegetarian:!0,bookable:!0,city:"Seattle, WA"},{id:7,name:"Mexican Fiesta",likes:44,savory:!0,sweet:!1,vegetarian:!1,bookable:!1,city:"Seattle"}]},function(e){e.exports={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.0",body:[{id:"cardHeader",type:"Container",items:[{id:"foodTruckName",type:"TextBlock",weight:"bolder",size:"medium"}]},{type:"Container",id:"cardBody",items:[{id:"foodTruckDetails",type:"ColumnSet",columns:[{type:"Column",width:"250",items:[{type:"FactSet",facts:[{id:"likes",title:"Likes:"},{id:"sweet",title:"Is Sweet:"},{id:"savory",title:"Is Savory:"},{id:"vegetarian",title:"Is Vegetarian:"}]}]}]}]}],actions:[{type:"Action.OpenUrl",title:"Read Yelp Reviews"}]}}]);
//# sourceMappingURL=server.js.map